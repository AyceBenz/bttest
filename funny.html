<!DOCTYPE html>
<html>
<head>
    <title>Bluetooth Audio Streamer</title>
</head>
<body>
    <h2>Bluetooth Audio Streamer</h2>
    <input type="file" id="fileInput" />
    <button id="connectBtn">Connect to Serial</button>
    <p id="status"></p>
    <script>
        let writer;
        let fileReader;
        let chunkSize = 40;  // Send 20 bytes as hex (40 hex characters)
        let serialPort;

        document.getElementById('fileInput').addEventListener('change', function(event) {
            const file = event.target.files[0];
            if (file) {
                fileReader = new FileReader();
                fileReader.onload = (e) => processFile(e.target.result);
                fileReader.readAsText(file);
            }
        });

        async function connectToSerial() {
            try {
                document.getElementById('status').textContent = 'Requesting Bluetooth Device...';
                serialPort = await navigator.serial.requestPort();
                document.getElementById('status').textContent = 'Opening Serial Port...';
                await serialPort.open({ baudRate: 115200 });
                writer = serialPort.writable.getWriter();
                document.getElementById('status').textContent = 'Connected to Serial 
